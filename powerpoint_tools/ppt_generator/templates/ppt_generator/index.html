{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Theme Applier</title>
</head>
<body>
    <div class="container mt-4">
        <h1 contenteditable="{{ user.is_superuser }}">PowerPoint Generator</h1>
        <p contenteditable="{{ user.is_superuser }}">Editable description for admins...</p>

            <div class="container mt-4">
                <form method="post" action="{% url 'save_presentation' %}">
                    {% csrf_token %}
                    <div class="form-group">
                        <label for="markupInput">Markup Input</label>
                        <textarea id="markupInput" class="form-control" name="markup" rows="20" cols="80"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="outputPath">Save Output As</label>
                        <input type="text" class="form-control" id="outputPath" name="output_path" placeholder="Enter filename (e.g., presentation.pptx)">
                    </div>
                    <button type="submit" class="btn btn-primary">Save</button>
                </form>
            </div>
    </div>
</body>
</html>



<!-- Script to handle form submission -->
{#<script>#}
{#    document.getElementById('pptxForm').addEventListener('submit', function(event) {#}
{#        event.preventDefault();#}
{##}
{#        var formData = new FormData(this);#}
{#        var xhr = new XMLHttpRequest();#}
{#        xhr.open('POST', '{% url 'save_presentation' %}', true);#}
{##}
{#        xhr.responseType = 'blob';  // Expect a binary response#}
{##}
{#        xhr.onload = function(e) {#}
{#            if (this.status === 200) {#}
{#                // Create a new Blob object for the response data#}
{#                var file = new Blob([this.response], {type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation'});#}
{##}
{#                // Create an anchor element and trigger a download#}
{#                var a = document.createElement('a');#}
{#                a.href = window.URL.createObjectURL(file);#}
{#                a.download = 'presentation.pptx';  // Set the file name#}
{#                document.body.appendChild(a);#}
{#                a.click();#}
{#                document.body.removeChild(a);#}
{#            }#}
{#        };#}
{##}
{#        xhr.send(formData);#}
{#    });#}
{#</script>#}